<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- ==== ==== -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kenia&family=Mukta:wght@300;700&display=swap" rel="stylesheet">


    <!-- Boxicons CSS -->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <title>Side Navigation Bar in HTML CSS JavaScript</title>
    <link rel="stylesheet" href="{% static 'css/navigations.css' %}" />
    <link rel="stylesheet" href="{% static 'css/main.css' %}" />
    <script>
      document.addEventListener("DOMContentLoaded", function (){
        const tablebody = document.querySelector('.insert-data')
        console.log(tablebody)

        fetch('http://127.0.0.1:8000/task/get-task-information/')
        .then( response => {
          return response.json()
        })
        .then(data => {
          console.log(data)
          task_list = data.data
          console.log( 'task_list',task_list)
          task_list.forEach(task => {
            console.log(task)
            console.log(task.id, task.title, task.drescription, task.priority, task.company_id);
          });

        })
        .catch(error => console.log(error))
      })

    </script>
  </head>
  <body>
    <!-- navigations -->
    <!-- navbar -->
    <nav class="navbar">
      <div class="logo_item" title="Trello, your task manager">
        <a href="#"><p>Trello</p></a>
      </div>

      <form method="GET" class="search_bar">
        <input type="text" name="search_query" value="" placeholder="search company or user" >
        <button type="submit">
          <i class="fa-solid fa-magnifying-glass search_bar_search_icon"></i>
        </button>
      </form>

      <div class="navbar_content">
        <i class="fa-regular fa-bell"></i>
        <i class="fa-solid fa-arrow-right-from-bracket"></i>
        <i class="fa-solid fa-bars"></i>
        <a href="#" >
          <img src="{% static 'images/img3.jpg' %}" alt="" class="profile" />
        </a>
      </div>
    </nav>

    <!-- sidebar -->
    <nav class="sidebar">
      <div class="menu_content">

        <ul class="menu_items">

          <li class="item" title="create new task">
            <a href="#" class="nav_link">
              <span class="navlink_icon">
                <i class="fa-solid fa-pen-to-square"></i>
              </span>
              <span class="navlink">Create Task</span>
            </a>
          </li>

          <!-- duplicate or remove this li tag if you want to add or remove navlink with submenu -->
          <!-- start -->
          <li class="item" title="company your are added">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-building"></i>
              </span>
              <span class="navlink">Company</span>
              <i class="bx bx-chevron-right arrow-left"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink">
                <img src="{% static 'images/img3.jpg' %}" alt="" class="company_logo" />
                <span class="navlink">Notice board</span>
              </a>
              <a href="#" class="nav_link sublink">
                <img src="{% static 'images/img3.jpg' %}" alt="" class="company_logo" />
                <span class="navlink">Notice board</span>
              </a>
              <a href="#" class="nav_link sublink">
                <span class="navlink">Nav Sub Link</span>
              </a>
            </ul>
          </li>
          <!-- end -->

          <!-- duplicate this li tag if you want to add or remove  navlink with submenu -->
          <!-- start -->
          <li class="item" title="company you created">
            <div href="#" class="nav_link submenu_item">
              <span class="navlink_icon">
                <i class="fa-solid fa-landmark-dome"></i>
              </span>
              <span class="navlink">Your Company</span>
              <i class="bx bx-chevron-right arrow-left"></i>
            </div>

            <ul class="menu_items submenu">
              <a href="#" class="nav_link sublink">
                <img src="{% static 'images/img3.jpg' %}" alt="" class="company_logo" />
                <span class="navlink">Notice board</span>
              </a>
              <a href="#" class="nav_link sublink">
                <img src="{% static 'images/img3.jpg' %}" alt="" class="company_logo" />
                <span class="navlink">Notice board</span>
              </a>
              <a href="#" class="nav_link sublink">
                <span class="navlink">Nav Sub Link</span>
              </a>
            </ul>
          </li>
          <!-- end -->

          <li class="item" title="Notices from companies">
            <a href="#" class="nav_link">
              <span class="navlink_icon">
                <i class="fa-solid fa-bullhorn navlink_icon_bullhorn"></i>
              </span>
              <span class="navlink">Notice Broad</span>
            </a>
          </li>

          <li class="item" title="company and task settings">
            <a href="#" class="nav_link">
              <span class="navlink_icon">
                <i class="fa-solid fa-gear"></i>
              </span>
              <span class="navlink">Setting</span>
            </a>
          </li>

          <li class="item" title="create new company" >
            <a href="#" class="nav_link">
              <span class="navlink_icon">
                <i class="fa-solid fa-square-plus"></i>
              </span>
              <span class="navlink">Create Company</span>
            </a>
          </li>

        </ul>

        <div class="bottom_content">
          <div class="bottom">
            <p>
              &copy; 2023 <a href="#">Trello Co. Ltd</a>. All rights reserved.
            </p>
          </div>
        </div>
      </div>
    </nav>

    <main>
      <div class="workspace-navbar">
        <div class="task-filter-div unstartedTask">Unstarted Task</div>
        <div class="task-filter-div task-filter-div-active ongoingTask">Ongoing Task</div>
        <div class="task-filter-div finishedTask">Finished Task</div>
        <div class="task-filter-div" id="createTask">Create Task</div>
        <div class="task-filter-div" id="searchTask">Search Task</div>
      </div>
      <div class="workspace-table-section">
        <div class="tWrap">
          <div class="tWrap__head">
            <table>
              <thead>
                <tr>
                  <th>Finishing Expected</th>
                  <th>Task Title</th>
                  <th>Priority</th>
                  <th>Company</th>
                </tr>
              </thead>
            </table>
          </div> <!--/.tWrap__head-->
          <div class="tWrap__body">
            <table>
              <tbody class="insert-data">
                <tr>
                  <td>BAF087</td>
                  <td><a href="#" class="table-anchor">Gabriel Gunderson</a></td>
                  <td>Space Monkeys (Mikkel)</td>
                  <td><a href="#">Weave Communications</a></td>
                </tr>
                <tr>
                  <td>CADBAD</td>
                  <td>Stephanie Zollowkowsky</td>
                  <td>NG Ninjas</td>
                  <td>Bubble</td>
                </tr>
                <tr>
                  <td>098765</td>
                  <td>Ichabod Chrane</td>
                  <td>Programmers 1</td>
                  <td>Sleepy Hollow Website</td>
                </tr>

                <tr>
                  <td>GABY08</td>
                  <td>Junior Case</td>
                  <td>Programmers 2</td>
                  <td>Izeni</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>
                <tr>
                  <td>1B011A</td>
                  <td>Lorem Ipsum</td>
                  <td>Dolor</td>
                  <td>Sit</td>
                </tr>



              </tbody>
            </table>
          </div> <!--/.tWrap__body-->
        </div> <!-- /.tWrap -->

      </div>

    </main>
    <!-- JavaScript -->
    <script>

      const unstartedTask = document.querySelector('.unstartedTask')
      const finishedTask = document.querySelector('.finishedTask')
      const ongoingTask = document.querySelector('.ongoingTask')
      console.log(unstartedTask)
      console.log(finishedTask)
      console.log(ongoingTask)

      unstartedTask.addEventListener('click', ()=>{
        console.log('unstarted clicked')
      })
      finishedTask.addEventListener('click', ()=>{
        console.log('finishedtask clicked')
      })
      ongoingTask.addEventListener('click', ()=>{
        console.log('ongoing clicked')
      })


    </script>
  </body>
</html>

{% for task in tasks %}
<tr>
  <td>{{task.finishing_expected}}</td>
  <td><a href="#" class="table-anchor">{{task.title}}</a></td>
  <td>{{task.priority}}</td>
  <td><a href="{% url 'company:company-profile' pk=task.company.id %}">{{task.company}}</a></td>
</tr>
{% endfor %}

const task_list = JSON.parse(data.data);
console.log('task_list',task_list)
{% csrf_token %}
const csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;
'X-CSRFToken': csrfToken,

const company = `<td><a href="{% url 'company:company-profile' pk=${task.company_id} %}">${task.company}</a></td>`;
// company.textContent = task.company;
row.appendChild(company);
document.addEventListener("DOMContentLoaded", function (){
  console.log('sanity check from block tag')
  const tablebody = document.querySelector('.insert-data')
  console.log(tablebody)
  const dataToSend = {
    status:'unstarted'
  }

  fetch('http://127.0.0.1:8000/task/get-task-information/',{
    method:'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body:JSON.stringify(dataToSend)
  })
  .then( response => {
    console.log(response)
    return response.json()
  })
  .then(data => {
    console.log(data)
    const task_list = data.data
    console.log('task_list',task_list)
    task_list.forEach(task => {
      console.log('task',task)
      console.log('finish',task.finishing_expected)
      console.log('title',task.title)
      console.log('priority',task.priority)
      console.log('company',task.company)
      console.log('company_id',task.company_id)
    });
  })
  .catch(error => console.log(error))

})

taskEditBtn.href = `http://127.0.0.1:8000/task/edit-task/${task.task_id}`;
console.log(taskEditBtn)

taskDeleteBtn.addEventListener('click', function(e){
  const confirmDelete = confirm('Are you sure you want to delete this Task')

  if (confirmDelete){
    console.log('confirmed delete of ', task.task_id)

    const delete_url = `http://127.0.0.1:8000/task/delete-task/${task.task_id}`;

    fetch(delete_url,{
      method: 'DELETE',
    }).then(response =>{
      console.log(response)
      return response.json()
    }).then(data =>{
      console.log(data)
    }).catch(error => console.log(error))
  }
})



<div class="task-modal-button-div">
  <button type="button" class="task-modal-button"><a href="#" class="modal-btn-edit">Edit</a></button>
  <button type="button" class="task-modal-button"><a href="#" class="modal-btn-delete">Delete</a></button>
</div>